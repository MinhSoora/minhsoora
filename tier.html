<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tier List Maker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #000;
            color: #fff;
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5rem;
            color: #fff;
            text-shadow: 2px 2px 4px rgba(255,255,255,0.3);
        }

        .controls {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
            align-items: center;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            font-size: 14px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-danger {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a52 100%);
            color: white;
        }

        .btn-danger:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 107, 0.4);
        }

        .input-group {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        input[type="text"], input[type="file"], input[type="color"] {
            padding: 10px;
            border: 2px solid #333;
            border-radius: 6px;
            background: #222;
            color: #fff;
            font-size: 14px;
        }

        input[type="text"]:focus, input[type="file"]:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 10px rgba(102, 126, 234, 0.3);
        }

        input[type="color"] {
            width: 50px;
            height: 40px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
        }

        .tierlist {
            border: 2px solid #333;
            border-radius: 12px;
            overflow: hidden;
            margin-bottom: 30px;
            background: #111;
        }

        .tier-row {
            display: flex;
            border-bottom: 2px solid #333;
            min-height: 100px;
        }

        .tier-row:last-child {
            border-bottom: none;
        }

        .tier-label {
            width: 150px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 24px;
            color: #000;
            position: relative;
            cursor: pointer;
        }

        .tier-label:hover {
            opacity: 0.9;
        }

        .tier-content {
            flex: 1;
            padding: 10px;
            background: #1a1a1a;
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: flex-start;
            min-height: 100px;
            border-left: 2px solid #333;
        }

        .tier-content.drag-over {
            background: #2a2a2a;
            border: 2px dashed #667eea;
        }

        .image-item {
            width: 80px;
            height: 80px;
            object-fit: cover;
            border-radius: 8px;
            cursor: grab;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }

        .image-item:hover {
            transform: scale(1.05);
            border-color: #667eea;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .image-item.dragging {
            opacity: 0.5;
            cursor: grabbing;
        }

        .image-pool {
            background: #111;
            border: 2px solid #333;
            border-radius: 12px;
            padding: 20px;
            min-height: 150px;
        }

        .image-pool h3 {
            margin-bottom: 15px;
            color: #fff;
            text-align: center;
        }

        .image-pool-content {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            justify-content: center;
        }

        .image-pool-content.drag-over {
            background: #2a2a2a;
            border-radius: 8px;
            padding: 10px;
        }

        .delete-btn {
            position: absolute;
            top: -5px;
            right: -5px;
            width: 20px;
            height: 20px;
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 50%;
            cursor: pointer;
            font-size: 12px;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .image-container {
            position: relative;
        }

        .image-container:hover .delete-btn {
            display: flex;
        }

        .tier-delete {
            position: absolute;
            top: 10px;
            right: 10px;
            background: #ff4757;
            color: white;
            border: none;
            border-radius: 50%;
            width: 25px;
            height: 25px;
            cursor: pointer;
            font-size: 12px;
            display: none;
        }

        .tier-row:hover .tier-delete {
            display: block;
        }

        @media (max-width: 768px) {
            .controls {
                flex-direction: column;
            }

            .tier-label {
                width: 100px;
                font-size: 18px;
            }

            .image-item {
                width: 60px;
                height: 60px;
            }

            .header h1 {
                font-size: 2rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üèÜ Tier List Maker</h1>
        </div>

        <div class="controls">
            <div class="input-group">
                <input type="text" id="tierName" placeholder="T√™n tier (VD: S, A, B...)" maxlength="10">
                <input type="color" id="tierColor" value="#ff4757">
                <button class="btn btn-primary" onclick="addTier()">‚ûï Th√™m Tier</button>
            </div>
            
            <div class="input-group">
                <input type="file" id="imageInput" accept="image/*" multiple>
                <button class="btn btn-primary" onclick="addImages()">üì∑ Th√™m ·∫¢nh</button>
            </div>
            
            <button class="btn btn-danger" onclick="clearAll()">üóëÔ∏è X√≥a T·∫•t C·∫£</button>
            <button class="btn btn-primary" onclick="saveData()">üíæ L∆∞u Data</button>
        </div>

        <div class="tierlist" id="tierlist">
            <!-- Tiers s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
        </div>

        <div class="image-pool">
            <h3>üì¶ Kho ·∫¢nh - K√©o ·∫£nh v√†o tier b·∫°n mu·ªën</h3>
            <div class="image-pool-content" id="imagePool">
                <!-- ·∫¢nh s·∫Ω ƒë∆∞·ª£c th√™m v√†o ƒë√¢y -->
            </div>
        </div>
    </div>

    <script>
        // S·ª≠ d·ª•ng bi·∫øn to√†n c·ª•c thay v√¨ localStorage trong m√¥i tr∆∞·ªùng n√†y
        let tierData = {
            tiers: [],
            images: []
        };

        // Kh·ªüi t·∫°o
        document.addEventListener('DOMContentLoaded', function() {
            loadData();
            setupEventListeners();
        });

        function setupEventListeners() {
            // NgƒÉn ch·∫∑n h√†nh vi m·∫∑c ƒë·ªãnh cho drag & drop
            document.addEventListener('dragover', e => e.preventDefault());
            document.addEventListener('drop', e => e.preventDefault());
        }

        function addTier() {
            const tierName = document.getElementById('tierName').value.trim();
            const tierColor = document.getElementById('tierColor').value;
            
            if (!tierName) {
                alert('Vui l√≤ng nh·∫≠p t√™n tier!');
                return;
            }

            const tier = {
                id: Date.now(),
                name: tierName,
                color: tierColor,
                images: []
            };

            tierData.tiers.push(tier);
            renderTiers();
            saveData();
            
            // Reset input
            document.getElementById('tierName').value = '';
        }

        function deleteTier(tierId) {
            const tierIndex = tierData.tiers.findIndex(t => t.id === tierId);
            if (tierIndex === -1) return;

            // Chuy·ªÉn ·∫£nh v·ªÅ pool
            const tier = tierData.tiers[tierIndex];
            tierData.images.push(...tier.images);
            
            // X√≥a tier
            tierData.tiers.splice(tierIndex, 1);
            
            renderTiers();
            renderImagePool();
            saveData();
        }

        function addImages() {
            const input = document.getElementById('imageInput');
            const files = input.files;

            for (let file of files) {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const image = {
                            id: Date.now() + Math.random(),
                            src: e.target.result,
                            name: file.name
                        };
                        tierData.images.push(image);
                        renderImagePool();
                        saveData();
                    };
                    reader.readAsDataURL(file);
                }
            }
            
            // Reset input
            input.value = '';
        }

        function renderTiers() {
            const tierlist = document.getElementById('tierlist');
            tierlist.innerHTML = '';

            tierData.tiers.forEach(tier => {
                const tierRow = document.createElement('div');
                tierRow.className = 'tier-row';
                tierRow.innerHTML = `
                    <div class="tier-label" style="background-color: ${tier.color}">
                        ${tier.name}
                        <button class="tier-delete" onclick="deleteTier(${tier.id})" title="X√≥a tier">√ó</button>
                    </div>
                    <div class="tier-content" data-tier-id="${tier.id}"></div>
                `;

                const tierContent = tierRow.querySelector('.tier-content');
                
                // Render ·∫£nh trong tier
                tier.images.forEach(image => {
                    const imageContainer = createImageElement(image, true);
                    tierContent.appendChild(imageContainer);
                });

                // Setup drop zone cho tier
                setupDropZone(tierContent, tier.id);
                
                tierlist.appendChild(tierRow);
            });
        }

        function renderImagePool() {
            const imagePool = document.getElementById('imagePool');
            imagePool.innerHTML = '';

            tierData.images.forEach(image => {
                const imageContainer = createImageElement(image, false);
                imagePool.appendChild(imageContainer);
            });

            // Setup drop zone cho image pool
            setupDropZone(imagePool, 'pool');
        }

        function createImageElement(image, inTier = false) {
            const container = document.createElement('div');
            container.className = 'image-container';
            
            const img = document.createElement('img');
            img.className = 'image-item';
            img.src = image.src;
            img.alt = image.name;
            img.draggable = true;
            img.dataset.imageId = image.id;

            const deleteBtn = document.createElement('button');
            deleteBtn.className = 'delete-btn';
            deleteBtn.innerHTML = '√ó';
            deleteBtn.onclick = () => deleteImage(image.id, inTier);

            // Drag events
            img.addEventListener('dragstart', function(e) {
                e.dataTransfer.setData('text/plain', image.id);
                img.classList.add('dragging');
            });

            img.addEventListener('dragend', function() {
                img.classList.remove('dragging');
            });

            container.appendChild(img);
            container.appendChild(deleteBtn);
            
            return container;
        }

        function setupDropZone(element, targetId) {
            element.addEventListener('dragover', function(e) {
                e.preventDefault();
                element.classList.add('drag-over');
            });

            element.addEventListener('dragleave', function(e) {
                if (!element.contains(e.relatedTarget)) {
                    element.classList.remove('drag-over');
                }
            });

            element.addEventListener('drop', function(e) {
                e.preventDefault();
                element.classList.remove('drag-over');
                
                const imageId = e.dataTransfer.getData('text/plain');
                moveImage(imageId, targetId);
            });
        }

        function moveImage(imageId, targetId) {
            let image = null;
            
            // T√¨m v√† x√≥a ·∫£nh t·ª´ v·ªã tr√≠ hi·ªán t·∫°i
            // Ki·ªÉm tra trong image pool
            const poolIndex = tierData.images.findIndex(img => img.id == imageId);
            if (poolIndex !== -1) {
                image = tierData.images.splice(poolIndex, 1)[0];
            }
            
            // Ki·ªÉm tra trong c√°c tier
            if (!image) {
                for (let tier of tierData.tiers) {
                    const tierIndex = tier.images.findIndex(img => img.id == imageId);
                    if (tierIndex !== -1) {
                        image = tier.images.splice(tierIndex, 1)[0];
                        break;
                    }
                }
            }

            if (!image) return;

            // Th√™m ·∫£nh v√†o v·ªã tr√≠ m·ªõi
            if (targetId === 'pool') {
                tierData.images.push(image);
            } else {
                const tier = tierData.tiers.find(t => t.id == targetId);
                if (tier) {
                    tier.images.push(image);
                }
            }

            renderTiers();
            renderImagePool();
            saveData();
        }

        function deleteImage(imageId, inTier) {
            if (inTier) {
                // X√≥a t·ª´ tier
                for (let tier of tierData.tiers) {
                    const index = tier.images.findIndex(img => img.id == imageId);
                    if (index !== -1) {
                        tier.images.splice(index, 1);
                        break;
                    }
                }
            } else {
                // X√≥a t·ª´ pool
                const index = tierData.images.findIndex(img => img.id == imageId);
                if (index !== -1) {
                    tierData.images.splice(index, 1);
                }
            }

            renderTiers();
            renderImagePool();
            saveData();
        }

        function clearAll() {
            if (confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a t·∫•t c·∫£ d·ªØ li·ªáu?')) {
                tierData = { tiers: [], images: [] };
                renderTiers();
                renderImagePool();
                saveData();
            }
        }

        function saveData() {
            // Trong m√¥i tr∆∞·ªùng th·ª±c t·∫ø, uncomment d√≤ng d∆∞·ªõi ƒë·ªÉ s·ª≠ d·ª•ng localStorage
            // localStorage.setItem('tierlistData', JSON.stringify(tierData));
            console.log('Data saved:', tierData);
        }

        function loadData() {
            try {
                // Trong m√¥i tr∆∞·ªùng th·ª±c t·∫ø, uncomment d√≤ng d∆∞·ªõi ƒë·ªÉ load t·ª´ localStorage
                // const saved = localStorage.getItem('tierlistData');
                // if (saved) {
                //     tierData = JSON.parse(saved);
                // }
                
                renderTiers();
                renderImagePool();
            } catch (error) {
                console.error('L·ªói khi load d·ªØ li·ªáu:', error);
                tierData = { tiers: [], images: [] };
            }
        }

        // Th√™m m·ªôt s·ªë tier m·∫´u
        function initSampleData() {
            tierData.tiers = [
                { id: 1, name: 'S', color: '#ff4757', images: [] },
                { id: 2, name: 'A', color: '#ffa502', images: [] },
                { id: 3, name: 'B', color: '#2ed573', images: [] },
                { id: 4, name: 'C', color: '#1e90ff', images: [] }
            ];
            renderTiers();
            saveData();
        }

        // Kh·ªüi t·∫°o d·ªØ li·ªáu m·∫´u n·∫øu ch∆∞a c√≥ d·ªØ li·ªáu
        if (tierData.tiers.length === 0) {
            initSampleData();
        }
    </script>
</body>
</html>
